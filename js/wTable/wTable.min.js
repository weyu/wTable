!function(a,t){a.fn.extend({wTable:function(e){var r={},e=a.extend(r,e),n=this,c=a(e.paging),i=e.url,l=1,o=0,s=this.attr("id"),u=s+"-paging_num_btn",f=s+"-paging_fl_btn",d={},h={reload:function(t){d="",a(t+"_reload").click()},reset:function(t){d={table:t.table,apiurl:t.apiurl,currPage:t.currPage?t.currPage:1},a(t.table+"_reload").click()}},p=function(){if(!e.search)return!1;var t={},r=[];return a.each(e.search.searchkey,function(e,n){"object"==typeof n&&(r=[],a.each(n,function(t,e){r.push(a(e).val())})),t[e]=r.length>1?r:a(n).val()}),t},v=function(t){i=t&&t.apiurl?t.apiurl:i,l=t&&t.currPage?t.currPage:l;var r=layer.msg("正在获取数据，请稍后...",{icon:16,shade:.05,time:0});a.ajax({type:"post",url:i,data:{currPage:l,rows:e.rows,search:p()},dataType:"json",success:function(t){function i(t,e){var r="";return null===e[t]?r="":void 0!=e[t]?r=e[t]:"object"==typeof t?(r=[],a.each(t,function(a,t){r.push(null===e[t]?"":void 0!=e[t]?e[t]:t)})):r=t,r}var d=t.data.list,h=t.data.totalCount,p=e.theadData?e.theadData:t.data.theadData,v="",g="",b="";if(o=Math.ceil(h/e.rows),a.each(p,function(a,t){v+="<th>"+t[0]+"</th>"}),a.each(d,function(t,r){var n="";a.each(p,function(a,t){"function"==typeof t[2]?n+="<td>"+t[2](i(t[1],r))+"</td>":n+="<td>"+i(t[1],r)+"</td>"});var c="";void 0!=e.trdata&&(c="function"==typeof e.trdata[2]?e.trdata[0]+'="'+e.trdata[2](i(e.trdata[1],r))+'"':e.trdata[0]+'="'+i(e.trdata[1],r)+'"'),g+="<tr "+c+">"+n+"</tr>"}),v="<theadData>"+v+"</theadData>",g="<tbody>"+g+"</tbody>",n.html(v+g),l<5&&o<=5&&o>1)for(var y=1;y<=o;y++){var m=y==l?"active":"";b+='<li class="'+u+" "+m+'"><a href="#">'+y+"</a></li>"}if(l<5&&o>5)for(var y=1;y<=5;y++){var m=y==l?"active":"";b+='<li class="'+u+" "+m+'"><a href="#">'+y+"</a></li>"}else if(l>=5&&l<o)for(var _=o-l==1?1:0,y=l+1-3-_;y<=l+2-_;y++){var m=y==l?"active":"";b+='<li class="'+u+" "+m+'"><a href="#">'+y+"</a></li>"}else if(l==o&&o>=5)for(var y=l-4;y<=l;y++){var m=y==l?"active":"";b+='<li class="'+u+" "+m+'"><a href="#">'+y+"</a></li>"}o>1&&(b='<li class="'+f+' prev-page"><a href="#">首页</a></li>'+b+'<li class="'+f+' next-page"><a href="#">末页</a></li>');var w=a("#"+s+"_reload").length<1?'<span id="'+s+'_reload"></span>':"",k=o>1?"当前页码"+l+"，共"+o+"页":"";c.parent().find("#"+s+"_nowPage").length<1&&c.parent().append('<p id="'+s+'_nowPage" class="nowpage-tips"></p>'),c.html(b).after(w),c.parent().find("#"+s+"_nowPage").html(k),layer.close(r),void 0!=e.callbacks&&e.callbacks(t)},error:function(){layer.msg("数据加载失败，请刷新页面重试")}})};a(document).on("click","."+u,function(){l=Number(a(this).text()),v()}),a(document).on("click","."+f,function(){a(this).hasClass("prev-page")?l=1:a(this).hasClass("next-page")&&(l=o),v()}),a(document).on("click","#"+s+"_reload",function(){v(d)}),e.search&&a(document).on("click",e.search.searchbtn,function(){if("function"==typeof e.search.searchpre){var a=e.search.searchpre();if(!1===a)return a}l=1,v()}),v(),t.$wTable=h}})}(jQuery,window);