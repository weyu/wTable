!function(a,t){a.fn.extend({wTable:function(e){var r={},e=a.extend(r,e),n=this,c=a(e.paging),i=e.url,o=e.currPage||1,l=0,s=this.attr("id"),u=s+"-paging_num_btn",f=s+"-paging_fl_btn",d={},h={reload:function(t){d="",a(t+"_reload").click()},reset:function(t){d={table:t.table,apiurl:t.apiurl,currPage:t.currPage?t.currPage:1},a(t.table+"_reload").click()}},p=function(){if(!e.search)return!1;var t={},r=[];return a.each(e.search.searchkey,function(e,n){"object"==typeof n&&(r=[],a.each(n,function(t,e){r.push(a(e).val())})),t[e]=r.length>1?r:a(n).val()}),t},g=function(){var a={currPage:o,rows:e.rows,search:p()};if(e.debug&&console.log("原始请求数据：",a),e.postData){var t=e.postData(a);return e.debug&&console.log("自定义请求数据：",t),t}return a},v=function(t){i=t&&t.apiurl?t.apiurl:i,o=t&&t.currPage?t.currPage:o;var r=layer.msg("正在获取数据，请稍后...",{icon:16,shade:.05,time:0});a.ajax({type:"post",url:i,data:g(),dataType:"json",success:function(t){function i(t,e){var r="";return null===e[t]?r="":void 0!=e[t]?r=e[t]:"object"==typeof t?(r=[],a.each(t,function(a,t){r.push(null===e[t]?"":void 0!=e[t]?e[t]:t)})):r=t,r}e.debug&&console.log("后台返回数据：",t);var d=t.data.list,h=t.data.totalCount,p=e.theadData?e.theadData:t.data.theadData,g="",v="",b="";if(l=Math.ceil(h/e.rows),a.each(p,function(a,t){g+="<th>"+t[0]+"</th>"}),a.each(d,function(t,r){var n="";a.each(p,function(a,t){"function"==typeof t[2]?n+="<td>"+t[2](i(t[1],r))+"</td>":n+="<td>"+i(t[1],r)+"</td>"});var c="";void 0!=e.trdata&&(c="function"==typeof e.trdata[2]?e.trdata[0]+'="'+e.trdata[2](i(e.trdata[1],r))+'"':e.trdata[0]+'="'+i(e.trdata[1],r)+'"'),v+="<tr "+c+">"+n+"</tr>"}),g="<theadData>"+g+"</theadData>",v="<tbody>"+v+"</tbody>",n.html(g+v),o<5&&l<=5&&l>1)for(var y=1;y<=l;y++){var m=y==o?"active":"";b+='<li class="'+u+" "+m+'"><a href="#">'+y+"</a></li>"}if(o<5&&l>5)for(var y=1;y<=5;y++){var m=y==o?"active":"";b+='<li class="'+u+" "+m+'"><a href="#">'+y+"</a></li>"}else if(o>=5&&o<l)for(var _=l-o==1?1:0,y=o+1-3-_;y<=o+2-_;y++){var m=y==o?"active":"";b+='<li class="'+u+" "+m+'"><a href="#">'+y+"</a></li>"}else if(o==l&&l>=5)for(var y=o-4;y<=o;y++){var m=y==o?"active":"";b+='<li class="'+u+" "+m+'"><a href="#">'+y+"</a></li>"}l>1&&(b='<li class="'+f+' prev-page"><a href="#">首页</a></li>'+b+'<li class="'+f+' next-page"><a href="#">末页</a></li>');var w=a("#"+s+"_reload").length<1?'<span id="'+s+'_reload"></span>':"",P=l>1?"当前页码"+o+"，共"+l+"页":"";c.parent().find("#"+s+"_nowPage").length<1&&c.parent().append('<p id="'+s+'_nowPage" class="nowpage-tips"></p>'),c.html(b).after(w),c.parent().find("#"+s+"_nowPage").html(P),layer.close(r),void 0!=e.callbacks&&e.callbacks(t)},error:function(){layer.msg("数据加载失败，请刷新页面重试")}})};a(document).on("click","."+u,function(){o=Number(a(this).text()),v()}),a(document).on("click","."+f,function(){a(this).hasClass("prev-page")?o=1:a(this).hasClass("next-page")&&(o=l),v()}),a(document).on("click","#"+s+"_reload",function(){v(d)}),e.search&&a(document).on("click",e.search.searchbtn,function(){if("function"==typeof e.search.searchpre){var a=e.search.searchpre();if(!1===a)return a}o=1,v()}),v(),t.$wTable=h}})}(jQuery,window);